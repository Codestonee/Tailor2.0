steps:
  # --- 1. BACKEND ---
  # Bygg Docker-image för Backend
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/$PROJECT_ID/tailor-backend', './backend']
  
  # Ladda upp bilden till Google Container Registry
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/$PROJECT_ID/tailor-backend']
  
  # Deploya till Cloud Run
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args: ['run', 'deploy', 'tailor-backend', '--image', 'gcr.io/$PROJECT_ID/tailor-backend', '--region', 'europe-north1', '--allow-unauthenticated']

  # --- 2. FRONTEND ---
  # Bygg Docker-image för Frontend
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/$PROJECT_ID/tailor-frontend', './Frontend']
  
  # Ladda upp bilden
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/$PROJECT_ID/tailor-frontend']
  
  # Deploya till Cloud Run
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args: ['run', 'deploy', 'tailor-frontend', '--image', 'gcr.io/$PROJECT_ID/tailor-frontend', '--region', 'europe-north1', '--allow-unauthenticated']

timeout: '1200s'
options:
  logging: CLOUD_LOGGING_ONLY